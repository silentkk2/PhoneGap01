<!DOCTYPE html>
<!--
Copyright (c) 2012-2014 Adobe Systems Incorporated. All rights reserved.

Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->


<html>
    <head>
        
<!--
This is an example that shows how to create an application that uses
an embedded sqlite database
in a mobile device (iphone,ipod,ipad,android using phonegap, jquery
and sqlite.

Your phonegap project will already contain the phonegap.js.

You will need to download and add to your project the jquery.min.js
file

The application will create a database called WebSqlDb with a
table in it called User, which contains three fields  UserId,
FirstName and LastName

When the application is run the firsttime, if the local database does
not exist, the application
will create the database and the table.

The application shows two text boxes which you can use to add values
to the database using the add record button

The application also has a refresh button which will get the data from
the database and show it on the screen

When the application is run on the device the onBodyLoad() function is
called, which sets up the database and table

The Add Record button calls the AddValueToDB() function

The Refresh button calls the ListDBValues() function

There are a few alert statements in this application, which are only
there for debuggin purposes.  They look like this
alert("DEBUGGING: followed by some text");

These are only in the application to indicate where the application is
at when it is processing functions, etc

You will need to comment these out before you deploy/sell your
application

-->
<link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" href="css/jquery.mobile-1.0.1.css" />
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/flashlight.js"></script>
        <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.4.5.js"></script>
        <script type="text/javascript" src="js/jquery-transform.js"></script>
        <script type="text/javascript" src="http://www.google.com/jsapi"></script>

 <script type="text/javascript" charset="utf-8">

// global variables
var db;
var shortName = 'WebSqlDB';
var version = '1.0';
var displayName = 'WebSqlDB';
var maxSize = 65535;

// this is called when an error happens in a transaction
function errorHandler(transaction, error) {
   alert('Error: ' + error.message + ' code: ' + error.code);

}

// this is called when a successful transaction happens
function successCallBack() {
   alert("DEBUGGING: success");

}

function nullHandler(){};

// called when the application loads
function onBodyLoad(){

// This alert is used to make sure the application is loaded correctly
// you can comment this out once you have the application working
alert("DEBUGGING: we are in the onBodyLoad() function");

 if (!window.openDatabase) {
   // not all mobile devices support databases  if it does not, the
//following alert will display
   // indicating the device will not be albe to run this application
   alert('Databases are not supported in this browser.');
   return;
 }

// this line tries to open the database base locally on the device
// if it does not exist, it will create it and return a database
//object stored in variable db
 db = openDatabase(shortName, version, displayName,maxSize);

// this line will try to create the table User in the database just
created/openned
 db.transaction(function(tx){

  // you can uncomment this next line if you want the User table to be
//empty each time the application runs
  // tx.executeSql( 'DROP TABLE User',nullHandler,nullHandler);

  // this line actually creates the table User if it does not exist
//and sets up the three columns and their types
  // note the UserId column is an auto incrementing column which is
//useful if you want to pull back distinct rows
  // easily from the table.
   tx.executeSql( 'CREATE TABLE IF NOT EXISTS User(UserId INTEGER NOT NULL PRIMARY KEY, FirstName TEXT NOT NULL, LastName TEXT NOT NULL)',
[],nullHandler,errorHandler);
 },errorHandler,successCallBack);

}

// list the values in the database to the screen using jquery to
//update the #lbUsers element
function ListDBValues() {

 if (!window.openDatabase) {
  alert('Databases are not supported in this browser.');
  return;
 }

// this line clears out any content in the #lbUsers element on the
//page so that the next few lines will show updated
// content and not just keep repeating lines
 $('#lbUsers').html('');

// this next section will select all the content from the User table
//and then go through it row by row
// appending the UserId  FirstName  LastName to the  #lbUsers element
//on the page
 db.transaction(function(transaction) {
   transaction.executeSql('SELECT * FROM User;', [],
     function(transaction, result) {
      if (result != null && result.rows != null) {
        for (var i = 0; i < result.rows.length; i++) {
          var row = result.rows.item(i);
          $('#lbUsers').append('<br>' + row.UserId + '. ' +
row.FirstName+ ' ' + row.LastName);
        }
      }
     },errorHandler);
 },errorHandler,nullHandler);

 return;

}

// this is the function that puts values into the database using the
// from the text boxes on the screen
function AddValueToDB() {

 if (!window.openDatabase) {
   alert('Databases are not supported in this browser.');
   return;
 }

// this is the section that actually inserts the values into the User
//table
 db.transaction(function(transaction) {
   transaction.executeSql('INSERT INTO User(FirstName, LastName) VALUES (?,?)',[$('#txFirstName').val(), $('#txLastName').val()],
     nullHandler,errorHandler);
   });

// this calls the function that will show what is in the User table in
//the database
 ListDBValues();

 return false;

}

</script>
</head>
<body onload="onBodyLoad()">
<h1>WebSQL</h1>
<input id="txFirstName" type="text" placeholder="FirstName">
<input id="txLastName" type="text" placeholder="Last Name">
<input type="button" value="Add record" onClick="AddValueToDB()">
<input type="button" value="Refresh" onClick="ListDBValues()"> <br>
<br>
<span style="font-weight:bold;">Currently stored values:</span>
<span id="lbUsers"></span>
</body>
<!--<html>
    <head>
        <meta charset="utf-8" />
         WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 

        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" href="css/jquery.mobile-1.0.1.css" />
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/flashlight.js"></script>
        <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.4.5.js"></script>
        <script type="text/javascript" src="js/jquery-transform.js"></script>
        <script type="text/javascript" src="http://www.google.com/jsapi"></script>
        <title>Hello World</title>
    </head>
    <body>
        
        <div data-role="page" id="index" data-theme="b">
            <div data-role="header">
                <h1>Tito Was Here</h1>
            </div>
            <div data-role="content">
                <form method="POST" onsubmit="return submitToDatabase()" data-ajax="false">
                    <div class="ui-field-contain">
                        <label for="fullname">Full name:</label>
                            <input type="text" name="fullname" id="fullname" data-clear-btn="true">       
                        <label for="bday">Date of Birth:</label>
                            <input type="date" name="bday" id="bday">
                        <label for="email">E-mail:</label>
                            <input type="email" name="email" id="email" placeholder="Your email..">
                    </div>
                    <fieldset data-role="controlgroup" data-type="horizontal" id="gender">
                        <legend>Choose your gender:</legend>
                        <label for="male">Male</label>
                            <input type="radio" name="gender" id="male" value="male">
                        <label for="female">Female</label>
                            <input type="radio" name="gender" id="female" value="female">	
                    </fieldset>

                    <fieldset data-role="controlgroup" data-type="horizontal">
                        <legend>Choose as many favorite colors as you'd like:</legend>
                        <label for="red">Red</label>
                            <input type="checkbox" name="favcolor" id="red" value="red">
                        <label for="green">Green</label>
                            <input type="checkbox" name="favcolor" id="green" value="green">
                        <label for="blue">Blue</label>
                            <input type="checkbox" name="favcolor" id="blue" value="blue">	
                    </fieldset>

                    <label for="switch">Flip Toggle Switch:</label>
                        <input type="checkbox" data-role="flipswitch" name="switch" id="switch">
                    <br/>
                    <input type="submit" data-inline="true" value="Submit">
                </form>
            </div>
        </div>
        
        
        <div data-role="page" id="page2" data-theme="b">
            <div data-role="header"  id="header">
                <a href="#index" data-transition="slide" data-direction="reverse" data-icon="home"> Home </a>
                <h1> Header</h1>
            </div>
            <div data-role="content"  id="content">
                <div id="output">
                    
                </div>
            </div>
            <div data-role="footer" id ="footer">
                <h4> Footer</h4>
            </div>
        </div>
        
        <div data-role="page" id="index" class="app">
            <div >
                <h1>Tito Was Here</h1>
            </div>
            <button type="button" onclick="flashlightToggle()">
                FlashLight
            </button>
            <div id="deviceready" class="blink">
                <p class="event listening">
                    Connecting to Device
                </p>
                <p class="event received">
                    Device is Ready
                </p>
                <p id="info"></p>
            </div>
            <div>
                <p id="compass"></p>
                <p><a href="mappage.html" data-transition="slide"> Map Page</a></p>
                <a href="#mappage" data-transition="slide"> Map </a>
            </div>
        </div>
        <div data-role="page" id="mappage">
            <div data-role="header" data-theme="b" id="mapHeader">
                <a href="#index" data-transition="slide" data-direction="reverse" data-icon="home"> Home </a>
                <h1>Map Header</h1>
            </div>
            <button type="button" onclick="rotateMapRight()">
                Rotate Right
            </button>
            <button type="button" onclick="rotateMapLeft()">
                Rotate Left
            </button>
            <div data-role="content" style="padding:0;" id="mapContent">
                <div id="map" style="width:100%;height:100%;"></div>
            </div>
            <div data-role="footer" data-theme="b" id ="mapFooter">
                <h4>Map Footer</h4>
            </div>
        </div>

        <script type="text/javascript">
                app.initialize();
                var database;
                 
                document.addEventListener("deviceready", onDeviceReady, false);

                function onDeviceReady() {
                    database = window.openDatabase("Database", "1.0", "Test DB", 2*1024*1024);
                    database.transaction(createDB, errorDB, successDB);
                }
                
                function createDB(tx){
                    alert("trying to create");
                    tx.executeSql('DROP TABLE EF EXISTS DEMO');
                    tx.executeSql('CREATE TABE IF NOT EXISTS TEST1 (id unique, name, birthday, email, gender)');
                    
                }
                
                function errorDB(err){
                    alert("Error Processing SQL: " + err);
                }
                
                function successDB(){
                    alert("yey");
                }
                    
                function insertDB(tx){
                    
                    var name = $('[name="fullname"]').val();
                    var bday = $('[name="bday"]').val();
                    var email = $('[name="email"]').val();
                    var gender = $("#gender :radio:checked").val();
                    
                    var sql = 'INSERT INTO TEST1 (name, birthday, email, gender) VALUES (?,?,?,?)';
                    
                    tx.executeSql(sql,[name, bday, email, gender], queryDB, errorDB);
                    
                    
                }
                
                function queryDB(tx){
                    alert("about to query");
                    
                    tx.executeSql('SELECT * FROM TEST1', [], renderList, errorDB);
                }
                
                function renderList(tx, results){
                    
                    var htmlString = '';
                    
                    var len = results.rows.length;
                    
                    for (var i = 0; i < len; i++){
                        htmlString += "Full Name: " + results.rows.item(i).name + "<br>" +
                            "Gender: " + results.rows.item(i).gender + "<br>" + 
                            "Date of Birth: " + results.rows.item(i).birthday + "<br>" + 
                            "Email: " + results.rows.item(i).email + '<hr/>';
                    }
                   
                    
                    $.mobile.changePage("#page2", {reverse: false, transition: "slide"});
                    
                    $('#output').html(htmlString);
                }
                
                
                
                function submitToDatabase(){

                    database.transaction(insertDB, errorDB);
                  
                    return false;
                    
                }
                
                 
                function submitToLocal(){
                    var name = $('[name="fullname"]').val();
                    var bday = $('[name="bday"]').val();
                    var email = $('[name="email"]').val();
                    var gender = $("#gender :radio:checked").val();
                    
                    window.localStorage.setItem("fullname", name);
                    window.localStorage.setItem("birthday", bday);
                    window.localStorage.setItem("email", email);
                    window.localStorage.setItem("gender", gender);
                    
                    $.mobile.changePage("#page2", {reverse: false, transition: "slide"});
                    
                    $('#output').html("Full Name: " + window.localStorage.getItem("fullname") + "<br>" +
                            "Gender: " + window.localStorage.getItem("gender") + "<br>" + 
                            "Date of Birth: " + window.localStorage.getItem("birthday") + "<br>" + 
                            "Email: " + window.localStorage.getItem("email"));
                    
                    return false;
                 }
                 
        </script>
        <script type="text/javascript">
           

//            var map;
//            var marker;
//            var infowindow;
//            var watchID;
//
//            $(document).ready(function () {
//                document.addEventListener("deviceready", onDeviceReady, false);
//                //for testing in Chrome browser uncomment
//                //onDeviceReady();
//            });
//
//            //PhoneGap is ready function
//            function onDeviceReady() {
//                $(window).unbind();
//                $(window).bind('pageshow resize orientationchange', function (e) {
//                    max_height();
//                });
//                max_height();
//                google.load("maps", "3.8", {
//                    "callback": map,
//                    other_params: "sensor=true&language=en"
//                });
//            }
//
//            function max_height() {
//                var h = $('div[data-role="header"]').outerHeight(true);
//                var f = $('div[data-role="footer"]').outerHeight(true);
//                var w = $(window).height();
//                var c = $('div[data-role="content"]');
//                var c_h = c.height();
//                var c_oh = c.outerHeight(true);
//                var c_new = w - h - f - c_oh + c_h;
//                var total = h + f + c_oh;
//                if (c_h < c.get(0).scrollHeight) {
//                    c.height(c.get(0).scrollHeight);
//                } else {
//                    c.height(c_new);
//                }
//            }
//
//            function map() {
//                var latlng = new google.maps.LatLng(55.17, 23.76);
//                var myOptions = {
//                    zoom: 6,
//                    center: latlng,
//                    streetViewControl: true,
//                    mapTypeId: google.maps.MapTypeId.ROADMAP,
//                    zoomControl: true
//                };
//                map = new google.maps.Map(document.getElementById("map"), myOptions);
//
//                google.maps.event.addListenerOnce(map, 'tilesloaded', function () {
//                    //get geoposition once
//                    //navigator.geolocation.getCurrentPosition(geo_success, geo_error, { maximumAge: 5000, timeout: 5000, enableHighAccuracy: true });
//                    //watch for geoposition change
//                    watchID = navigator.geolocation.watchPosition(geo_success, geo_error, {
//                        maximumAge: 5000,
//                        timeout: 5000,
//                        enableHighAccuracy: true
//                    });
//                });
//            }
//
//            function geo_error(error) {
//                //comment
//                alert('code: ' + error.code + '\n' + 'message: ' + error.message + '\n');
//            }
//
//            function geo_success(position) {
//
//                map.setCenter(new google.maps.LatLng(position.coords.latitude, position.coords.longitude));
//                map.setZoom(15);
//
//                var info = (
//                        'Latitude: ' + position.coords.latitude + '<br>' + 
//                        'Longitude: ' + position.coords.longitude + '<br>' + 
//                        'Altitude: ' + position.coords.altitude + '<br>' + 
//                        'Accuracy: ' + position.coords.accuracy + '<br>' + 
//                        'Altitude Accuracy: ' + position.coords.altitudeAccuracy + '<br>' + 
//                        'Heading: ' + position.coords.heading + '<br>' + 
//                        'Speed: ' + position.coords.speed + '<br>' + 
//                        'Timestamp: ' + new Date(position.timestamp)
//                        );
//
//                var point = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
//                if (!marker) {
//                    //create marker
//                    marker = new google.maps.Marker({
//                        position: point,
//                        map: map
//                    });
//                } else {
//                    //move marker to new position
//                    marker.setPosition(point);
//                }
//                if (!infowindow) {
//                    infowindow = new google.maps.InfoWindow({
//                        content: info
//                    });
//                } else {
//                    infowindow.setContent(info);
//                }
//                google.maps.event.addListener(marker, 'click', function () {
//                    infowindow.open(map, marker);
//                });
//            }
        </script>
    </body>
</html>-->
